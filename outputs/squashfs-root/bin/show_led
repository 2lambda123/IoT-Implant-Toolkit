#!/bin/sh

case "$0" in
    *show_led)
	mode="show"
    ;;
    *shut_led)
	mode="shut"
    ;;
esac

[ ! -z $LED_PARENT ] && logger -t ledserver -p 3 "$LED_PARENT call $0 $*"
#export LED_PARENT=

if [ "$mode" = "show" ]; then
    case "$1" in
	"c")
	    ubus -t 1 call led shut
	    ;;
	"8")
	    OP="$1"
	    RGB="$2"
	    ubus -t 1 call led show "{\"L\":$OP, \"rgb\":\"$RGB\"}"
	    ;;
	*)
	    OP="$1"
	    POS="$2"
	    if [ -n "$POS" ]; then
		ubus -t 1 call led show "{\"L\":$OP,\"pos\":$POS}"
	    else
		ubus -t 1 call led show "{\"L\":$OP}"
	    fi
	    ;;
    esac
else
    OP="$1"
    ubus -t 1 call led shut "{\"L\":$OP}"
fi


